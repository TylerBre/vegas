---
layout: quirkey_code
title: vegas
github_name: vegas
current_version: 0.1.4
nav:
  - name: What
    link: "#what"
  - name: Why
    link: "#why"
  - name: Usage
    link: "#usage"
  - name: Dependencies
    link: "#dependencies"
---

h2(project_name). {{ page.github_name }}

h3(#what). What

Vegas aims to solve the simple problem of creating executable versions of Sinatra/Rack apps. 

h3(#why). Why

I have a vision of a future where all us developers release gems with simple local web interfaces powered by Sinatra. I see Vegas as a little shove and an easy first step in making this vision come true. 

I presented about "Sinatra: The Framework Within" at GoGaRuCo 2009: "Check out the full video.":http://pivotallabs.com/talks/51-sinatra-the-framework-within

h3(#usage). Usage

Currently, vegas contains a single class @Vegas::Runner@ that provides a wrapper for a Sinatra app to easily make it into an executable bin. 

Lets say you have a Sinatra app that looks like:

{% highlight ruby %}
# /my_app.rb
require 'rubygems'
require 'sinatra/base'

class MyApp < Sinatra::Base
  
  get '/' do
    "This is my app"
  end
  
end
{% endhighlight %}

You can turn this into a simple binary:

{% highlight ruby %}
  #!/usr/bin/env ruby
  # /myapp

  require File.expand_path(File.dirname(__FILE__) + 'myapp.rb')
  require 'vegas'

  Vegas::Runner.new(MyApp, 'my_app')
{% endhighlight %}

Now if you run @./my_app@ it should:
* find an appropriate rack handler (thin. mongrel)
* find an available port
* launch the app in a browser
* put itself in the background
* write a .pid and a .url file

Running it with @-h@ or @--help@ will print a list of available command line options. You can even add options specific to your app by using a block.

{% highlight ruby %}
Vegas::Runner.new(AppClass, 'app_name') do |runner, opts, app|
  # runner is the instance of Vegas::Runner
  # opts is an option parser object
  # app is your app class
end
{% endhighlight %}

As of version 0.0.3, Vegas::Runner and its daemon-ization is fully compatible with Windows.

h4. Rack Apps

Vegas (> v0.1.0) is not dependent on Sinatra. Vegas works almost exactly the same for general Rack Applications. For example, this will work as expected:

{% highlight ruby %}
#!/usr/bin/env ruby

require 'vegas'

app = Proc.new {|env| 
  [200, {'Content-Type' => 'text/plain'}, ["This is an app. #{env.inspect}"]]
}

Vegas::Runner.new(app, 'rack_app')
{% endhighlight %}


h3(#dependencies). Dependencies

Vegas requires:

* rack >= 0.1.0

On Windows, there is an additional requirement of the @win32-process@ gem.